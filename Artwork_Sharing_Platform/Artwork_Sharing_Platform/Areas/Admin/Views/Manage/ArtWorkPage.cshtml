
@{
    ViewBag.Title = "ArtWorkPage";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutAdminPage.cshtml";
}

<h2>ArtWorkPage</h2>

<div id="page-wrapper">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">ArtWorkPage</h1>
            </div>
            <!-- /.col-lg-12 -->
        </div>
        <div class="panel-body">
            <div class="row">
                <div class="col-lg-12">
                    <div class="row">
                        <div class="input-group custom-search-form col-lg-8">
                            <input type="text" id="searchInput" class="form-control" placeholder="Search...">
                            <span class="input-group-btn">
                                <button class="btn btn-primary" type="button" onclick="searchTable()">
                                    <i class="fa fa-search"></i>
                                </button>
                            </span>
                        </div>

                    </div>

                    <div class="table-responsive">
                        <table id="transactionTable" class="table table-bordered table-hover table-striped">
                            <thead>
                                <tr>
                                    <th>Artwork Id</th>
                                    <th>UserId</th>
                                    <th>Date Post</th>
                                    <th>Picturel</th>
                                    <th>View Detail</th>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                    <!--<div class="modal fade" id="userDetailModal" tabindex="-1" aria-labelledby="userDetailModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="userDetailModalLabel">User Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">-->
                    <!-- User details will be displayed here -->
                    <!--</div>
            </div>
        </div>
    </div>-->
                    <div class="modal fade" id="viewDetailModal" tabindex="-1" role="dialog" aria-labelledby="viewDetailModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="viewDetailModalLabel">Artwork Detail</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <div id="viewDetailModalContent"></div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    fetch('https://localhost:7008/api/Arwork/GetAllArtwork')
        .then(response => response.json())
        .then(data => {
            const tbody = document.querySelector('#transactionTable tbody');
            for (const item of data) {
                const row = document.createElement('tr');
                const contentCell = document.createElement('td');
                contentCell.textContent = item.artworkPId;
                row.appendChild(contentCell);
                const userIdCell = document.createElement('td');
                userIdCell.textContent = item.userId;
                row.appendChild(userIdCell);
                const datePostCell = document.createElement('td');
                datePostCell.textContent = formatDate(item.datePost);
                row.appendChild(datePostCell);
                const pictureCell = document.createElement('td');
                const pictureImg = document.createElement('img');

                pictureImg.src = 'data:image/jpeg;base64,' + item.pictureArtwork;
                pictureImg.style.height = '100px';
                pictureCell.appendChild(pictureImg);
                row.appendChild(pictureCell);

                const detailButtonCell = document.createElement('td');
                const detailButton = document.createElement('button');
                detailButton.textContent = "View Detail";
                detailButton.className = "btn btn-primary";
                detailButton.addEventListener("click", function () {
                    viewDetail(item);
                });
                detailButtonCell.appendChild(detailButton);
                row.appendChild(detailButtonCell);

                tbody.appendChild(row);
            }
        })
        .catch(error => {
            console.error('Error fetching data:', error);
        });
    //function viewDetail(user) {
    //    showUserDetailModal(user);
    //}

    //function showUserDetailModal(user) {
    //    const modalBody = $("#userDetailModal .modal-body");

    //    modalBody.empty();

    //    const userDetailElement = $("<dl>");

    //    //userDetailElement.append($("<dt>").text("ID:"));
    //    //userDetailElement.append($("<dd>").text(user.id));

    //    //userDetailElement.append($("<dt>").text("User Name:"));
    //    //userDetailElement.append($("<dd>").text(user.userName));

    //    //userDetailElement.append($("<dt>").text("Email:"));
    //    //userDetailElement.append($("<dd>").text(user.email));

    //    //userDetailElement.append($("<dt>").text("Address:"));
    //    //userDetailElement.append($("<dd>").text(user.address));

    //    //userDetailElement.append($("<dt>").text("Gender:"));
    //    //userDetailElement.append(
    //    //    user.gender
    //    //        ? $("<dd>").text("Male")
    //    //        : $("<dd>").text("Female")
    //    //);

    //    //userDetailElement.append($("<dt>").text("Phone Number:"));
    //    //userDetailElement.append($("<dd>").text(user.phoneNumber));

    //    //userDetailElement.append($("<dt>").text("Date of Birth:"));
    //    //userDetailElement.append($("<dd>").text(formatDate(user.dob)));

    //    //userDetailElement.append($("<dt>").text("Full Name:"));
    //    //userDetailElement.append($("<dd>").text(user.fullName));

    //    //userDetailElement.append($("<dt>").text("Date User Re:"));
    //    //userDetailElement.append($("<dd>").text(formatDate(user.dateUserRe)));

    //    //userDetailElement.append($("<dt>").text("Roles:"));
    //    //userDetailElement.append($("<dd>").text(user.roles.join(", ")));

    //    modalBody.append(userDetailElement);

    //    // Show the modal
    //    $("#userDetailModal").modal("show");
    //}

    function viewDetail(item) {
        const viewDetailModalContent = document.querySelector('#viewDetailModalContent');
        viewDetailModalContent.innerHTML = `
        <p><strong>Artwork ID:</strong> ${item.artworkPId}</p>
        <p><strong>Content:</strong> ${item.contentArtwork}</p>
        <p><strong>Description:</strong> ${item.description}</p>
        <p><strong>Price:</strong> ${item.priceArtwork}</p>
        <p><strong>Date Posted:</strong> ${formatDate(item.datePost)}</p >
        <p><strong>Picture:</strong></p>
        <img src="data:image/jpeg;base64,${item.pictureArtwork}" style="height: 200px;">
        <p><strong>Genre ID:</strong> ${item.genreId}</p>
        <p><strong>User ID:</strong> ${item.userId}</p>
        <p><strong>Quantity:</strong> ${item.quanity}</p>
        <p><strong>Status:</strong> ${item.status ? "Active" : "Inactive"}</p>
    `;
        $('#viewDetailModal').modal('show');
    }

    // Helper function to format the date
    function formatDate(date) {
        return new Date(date).toLocaleDateString();
    }
</script>