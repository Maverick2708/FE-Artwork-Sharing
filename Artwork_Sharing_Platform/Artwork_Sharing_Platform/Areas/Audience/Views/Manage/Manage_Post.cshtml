@{
    Layout = "~/Views/Shared/defaultAuthor.cshtml";
}
<style>

    #comments {
        max-width: 600px;
        margin: 20px auto;
        font-family: 'Arial', sans-serif;
    }

    .comment {
        background-color: #f8f8f8;
        padding: 10px;
        margin: 10px 0;
        border-radius: 5px;
        position: relative;
    }

    .like {
        position: absolute;
        top: 5px;
        right: 5px;
        cursor: pointer;
        color: #e44d26; /* Màu sắc mặc định của trái tim */
    }

    color: black; /* Màu sắc khi số lượng thả tim là 0 */
    }

    .like:hover {
        color: #e44d26; /* Màu sắc khi hover (có thể giữ nguyên màu đỏ) */
    }

    .comment-input {
        width: 100%;
        padding: 10px;
        margin: 10px 0;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-sizing: border-box;
    }

    .comment-btn {
        background-color: #4caf50;
        color: white;
        padding: 10px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }

    .comment-input-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .comment-input {
        flex: 1;
        margin-right: 10px; /* Adjust the spacing between input and button as needed */
    }

    .comment-btn {
        flex-shrink: 0; /* Prevent button from shrinking */
    }
</style>

<section class="bg-gray200 pt-5 pb-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-7">
                <article class="card">
                  
                    <img id="artworkImage" class="card-img-top mb-2" src="" alt="Card image">
                    <div class="card-body">
                        <h1 id="artworkTitle">
                        </h1>
                        <h3 id="artworkPrice">
                        </h3>

                        <div id="ratingContainer" class="d-flex align-items-center">
                            <div id="starRatingContainer"></div>
                            <span id="likeCount" class="ml-2" onclick="addLike()"><i id="heartIcon" class="fa fa-heart text-danger"></i> <span id="likeCountValue">0</span></span>
                        </div>
                        <!-- Begin Comments -replace demowebsite with your own id
    <!-- Bình luận -->
                        <div id="comments" class="mt-4">
                            <!-- Hiển thị danh sách bình luận từ cơ sở dữ liệu -->
                        </div>
                        <div class="comment-input-container">
                            <input type="text" id="commentInput" class="comment-input" placeholder="Enter your comment">
                            <button type="button" class="comment-btn" onclick="addComment()">Send</button>
                        </div>
                        <span id="datePost" style="color: grey;"></span>
                        <script>
                            // Hàm để thêm bình luận mới
                            function addComment() {
                                var commentInput = document.getElementById('commentInput').value;

                                // Kiểm tra xem có nội dung bình luận hay không
                                if (commentInput.trim() === '') {
                                    alert('Vui lòng nhập nội dung bình luận.');
                                    return;
                                }

                                // Tạo một đối tượng bình luận (có thể có thêm thông tin như user_id, timestamp, ...)
                                var comment = {
                                    content: commentInput,
                                    likes: 0 // Số lượng thả tim ban đầu
                                };

                                // Thêm bình luận vào danh sách hiển thị
                                displayComment(comment);

                                // Đồng thời, bạn cũng có thể gửi dữ liệu lên máy chủ để lưu vào cơ sở dữ liệu
                                // Sử dụng AJAX hoặc Fetch API để gửi dữ liệu

                                // Reset input sau khi thêm bình luận
                                document.getElementById('commentInput').value = '';
                            }

                            // Hàm để hiển thị bình luận
                            function displayComment(comment) {
                                var commentsContainer = document.getElementById('comments');

                                // Tạo một phần tử HTML để hiển thị bình luận
                                var commentElement = document.createElement('div');
                                commentElement.className = 'comment';
                                commentElement.innerHTML = `
                                                                <p>${comment.content}</p>
                                                                <span class="like" onclick="likeComment(this)">&hearts; <span class="like-count">${comment.likes}</span></span>
                                                            `;
                                if (comment.likes > 0) {
                                    commentElement.querySelector('.like').classList.add('liked');
                                }
                                // Thêm phần tử vào container
                                commentsContainer.appendChild(commentElement);
                            }

                            // Hàm để thả tim cho bình luận
                            function likeComment(span) {
                                var likeCountElement = span.querySelector('.like-count');
                                var likeCount = parseInt(likeCountElement.innerText, 10);

                                // Kiểm tra xem đã thả tim chưa
                                if (span.classList.contains('liked')) {
                                    likeCount--;
                                    span.classList.remove('liked');
                                } else {
                                    likeCount++;
                                    span.classList.add('liked');
                                }

                                likeCountElement.innerText = likeCount;

                                // Bạn cũng có thể gửi yêu cầu lên máy chủ để cập nhật số lượng thả tim trong cơ sở dữ liệu
                            }
                            var starRating = 3; // Replace with the actual database value
                            var likeCountValue = 0;

                            var isLiked = false; // Trạng thái ban đầu là chưa thả tim
                            var likeCountValue = 0;
                            // Function to generate the star rating
                            function generateStarRating() {
                                var starRatingContainer = document.getElementById('starRatingContainer');
                                starRatingContainer.innerHTML = ''; // Clear previous content

                                // Create a star for each rating
                                for (var i = 0; i < starRating; i++) {
                                    var star = document.createElement('i');
                                    star.className = 'fa fa-star text-warning'; // Assuming FontAwesome for stars
                                    starRatingContainer.appendChild(star);
                                }

                                // You can add half stars or empty stars based on your requirements
                            }
                            function addLike() {
                                if (isLiked) {
                                    // Nếu đã thả tim, ẩn tim và giảm số lượng người thả tim
                                    isLiked = false;
                                    likeCountValue--;
                                } else {
                                    // Nếu chưa thả tim, hiển thị tim và tăng số lượng người thả tim
                                    isLiked = true;
                                    likeCountValue++;
                                }

                                // Cập nhật số lượng người thả tim
                                document.getElementById('likeCountValue').innerText = likeCountValue;

                                // Thay đổi trạng thái trái tim (đỏ hoặc đen)
                                var heartIcon = document.getElementById('heartIcon');
                                heartIcon.classList.toggle('text-danger', isLiked);

                                // Bạn cũng có thể gửi yêu cầu lên máy chủ để cập nhật số lượng thả tim trong cơ sở dữ liệu
                            }
                            // Call the function to generate the star rating
                            generateStarRating();


                            $(document).ready(function () {
                                // Lấy thông tin artworkId từ URL
                                var artworkId = getParameterByName('artworkid');

                                // Kiểm tra xem artworkId có tồn tại không
                                if (artworkId) {
                                    // Gọi API GetArtworkById với artworkId
                                    $.ajax({
                                        type: 'GET',
                                        url: `https://localhost:7008/api/Arwork/GetArtworkById?artworkid=${artworkId}`,
                                        success: function (response) {
                                            // Hiển thị dữ liệu từ API lên trang
                                            displayArtworkData(response);
                                        },
                                        error: function (error) {
                                            console.error('Lỗi:', error);
                                        }
                                    });
                                }

                                // Hàm để hiển thị dữ liệu từ API lên trang
                                function displayArtworkData(data) {
                                    // Thực hiện các thay đổi cần thiết để hiển thị dữ liệu
                                    document.getElementById('artworkTitle').innerText = data.contentArtwork;
                                    // Thêm các thông tin khác tùy thuộc vào cấu trúc dữ liệu của API
                                    document.getElementById('artworkImage').src = 'data:image/jpeg;base64,' + data.pictureArtwork;
                                    document.getElementById('artworkPrice').innerText = (data.priceArtwork).toLocaleString('vi-VN') + 'VNĐ';
                                    var datePost = new Date(data.datePost);
                                    var formattedDate = ('0' + datePost.getDate()).slice(-2) + '-' + ('0' + (datePost.getMonth() + 1)).slice(-2) + '-' + datePost.getFullYear();
                                    document.getElementById('datePost').innerText = formattedDate;
                                }


                                // Hàm để lấy giá trị của tham số từ URL
                                function getParameterByName(name, url) {
                                    if (!url) url = window.location.href;
                                    name = name.replace(/[[]]/g, "\$&");
                                    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                                        results = regex.exec(url);
                                    if (!results) return null;
                                    if (!results[2]) return '';
                                    return decodeURIComponent(results[2].replace(/\+/g, ' '));
                                }
                            });


                        </script>

                    </div>
                </article>
            </div>
        </div>
    </div>
    
    
    
    <div class="container-fluid mt-5">
        
    </div>
</section>
